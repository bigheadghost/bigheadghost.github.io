<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Dive into Project Euler Part 3 (41-60) - Know Nothing</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="bigheadghost" /><meta name="description" content="Problem 41 1 2  Max@Table[ Select[FromDigits /@ Permutations[Range[i]], PrimeQ], {i, 9}] 7652413   Problem 42 1 2 3 4 5 6  s = (Total[ToCharacterCode[#] - First@ToCharacterCode[&amp;#34;A&amp;#34;] &#43; 1]) &amp;amp; /@ StringSplit[StringReplace[Import[&amp;#34;R:\\words.txt&amp;#34;], &amp;#34;\&amp;#34;&amp;#34; -&amp;gt; &amp;#34;&amp;#34;], &amp;#34;,&amp;#34;]; Reduce[n*(n &#43; 1)/2 &amp;gt;Max[s] &amp;amp;&amp;amp; n &amp;gt; 0, n, Integers] n &amp;gt;= 20 In[37]:= tn = Array[#*(# &#43; 1)/2 &amp;amp;, 20]; In[38]:= Select[s, MemberQ[tn, #] &amp;amp;] // Length Out[38]= 162   Problem 43 1 2 3 4 5 6 7 8 9 10 11 12 13 14  cf = With[{ code = And @@ Thread[ Table[100 A[[i]] &#43; 10 A[[i &#43; 1]] &#43; A[[i &#43; 2]], {i, 2, 8}]~ Mod~{2, 3, 5, 7, 11, 13, 17} == 0] // Boole // Quiet }, Compile[{ {A, _Integer, 1} }, code, RuntimeAttributes -&amp;gt; Listable, RuntimeOptions -&amp;gt; &amp;#34;Speed&amp;#34;, CompilationTarget -&amp;gt; &amp;#34;C&amp;#34; ] ]; FromDigits /@ Pick[#, cf@#, 1] &amp;amp;@Permutations@Range[0, 9] // Tr 16695334890   " />






<meta name="generator" content="Hugo 0.83.1 with theme even" />


<link rel="canonical" href="https://bigheadghost.github.io/post/dive-into-project-euler-part-3-41-60/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.b5a744db6de49a86cadafb3b70f555ab443f83c307a483402259e94726b045ff.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Dive into Project Euler Part 3 (41-60)" />
<meta property="og:description" content="Problem 41


1
2


Max@Table[ Select[FromDigits /@ Permutations[Range[i]], PrimeQ], {i, 9}]
7652413


Problem 42


1
2
3
4
5
6


s = (Total[ToCharacterCode[#] - First@ToCharacterCode[&#34;A&#34;] &#43; 1]) &amp; /@ StringSplit[StringReplace[Import[&#34;R:\\words.txt&#34;], &#34;\&#34;&#34; -&gt; &#34;&#34;],   &#34;,&#34;];
Reduce[n*(n &#43; 1)/2 &gt;Max[s] &amp;&amp; n &gt; 0, n, Integers]
n &gt;= 20
In[37]:= tn = Array[#*(# &#43; 1)/2 &amp;, 20];
In[38]:= Select[s, MemberQ[tn, #] &amp;] // Length
Out[38]= 162


Problem 43


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14


cf = With[{
    code =
     And @@ Thread[
         Table[100 A[[i]] &#43; 10 A[[i &#43; 1]] &#43; A[[i &#43; 2]], {i, 2, 8}]~
           Mod~{2, 3, 5, 7, 11, 13, 17} == 0] // Boole // Quiet
    },
   Compile[{ {A, _Integer, 1} },
    code,
    RuntimeAttributes -&gt; Listable,
    RuntimeOptions -&gt; &#34;Speed&#34;, CompilationTarget -&gt; &#34;C&#34;
    ]
   ];
FromDigits /@ Pick[#, cf@#, 1] &amp;@Permutations@Range[0, 9] // Tr
16695334890


" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bigheadghost.github.io/post/dive-into-project-euler-part-3-41-60/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2014-09-02T12:04:41&#43;08:00" />
<meta property="article:modified_time" content="2014-09-02T12:04:41&#43;08:00" />

<meta itemprop="name" content="Dive into Project Euler Part 3 (41-60)">
<meta itemprop="description" content="Problem 41


1
2


Max@Table[ Select[FromDigits /@ Permutations[Range[i]], PrimeQ], {i, 9}]
7652413


Problem 42


1
2
3
4
5
6


s = (Total[ToCharacterCode[#] - First@ToCharacterCode[&#34;A&#34;] &#43; 1]) &amp; /@ StringSplit[StringReplace[Import[&#34;R:\\words.txt&#34;], &#34;\&#34;&#34; -&gt; &#34;&#34;],   &#34;,&#34;];
Reduce[n*(n &#43; 1)/2 &gt;Max[s] &amp;&amp; n &gt; 0, n, Integers]
n &gt;= 20
In[37]:= tn = Array[#*(# &#43; 1)/2 &amp;, 20];
In[38]:= Select[s, MemberQ[tn, #] &amp;] // Length
Out[38]= 162


Problem 43


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14


cf = With[{
    code =
     And @@ Thread[
         Table[100 A[[i]] &#43; 10 A[[i &#43; 1]] &#43; A[[i &#43; 2]], {i, 2, 8}]~
           Mod~{2, 3, 5, 7, 11, 13, 17} == 0] // Boole // Quiet
    },
   Compile[{ {A, _Integer, 1} },
    code,
    RuntimeAttributes -&gt; Listable,
    RuntimeOptions -&gt; &#34;Speed&#34;, CompilationTarget -&gt; &#34;C&#34;
    ]
   ];
FromDigits /@ Pick[#, cf@#, 1] &amp;@Permutations@Range[0, 9] // Tr
16695334890


"><meta itemprop="datePublished" content="2014-09-02T12:04:41&#43;08:00" />
<meta itemprop="dateModified" content="2014-09-02T12:04:41&#43;08:00" />
<meta itemprop="wordCount" content="1031">
<meta itemprop="keywords" content="Mathematica," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Dive into Project Euler Part 3 (41-60)"/>
<meta name="twitter:description" content="Problem 41


1
2


Max@Table[ Select[FromDigits /@ Permutations[Range[i]], PrimeQ], {i, 9}]
7652413


Problem 42


1
2
3
4
5
6


s = (Total[ToCharacterCode[#] - First@ToCharacterCode[&#34;A&#34;] &#43; 1]) &amp; /@ StringSplit[StringReplace[Import[&#34;R:\\words.txt&#34;], &#34;\&#34;&#34; -&gt; &#34;&#34;],   &#34;,&#34;];
Reduce[n*(n &#43; 1)/2 &gt;Max[s] &amp;&amp; n &gt; 0, n, Integers]
n &gt;= 20
In[37]:= tn = Array[#*(# &#43; 1)/2 &amp;, 20];
In[38]:= Select[s, MemberQ[tn, #] &amp;] // Length
Out[38]= 162


Problem 43


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14


cf = With[{
    code =
     And @@ Thread[
         Table[100 A[[i]] &#43; 10 A[[i &#43; 1]] &#43; A[[i &#43; 2]], {i, 2, 8}]~
           Mod~{2, 3, 5, 7, 11, 13, 17} == 0] // Boole // Quiet
    },
   Compile[{ {A, _Integer, 1} },
    code,
    RuntimeAttributes -&gt; Listable,
    RuntimeOptions -&gt; &#34;Speed&#34;, CompilationTarget -&gt; &#34;C&#34;
    ]
   ];
FromDigits /@ Pick[#, cf@#, 1] &amp;@Permutations@Range[0, 9] // Tr
16695334890


"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Know Nothing</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/zh">
        <li class="mobile-menu-item">Chinese Version(中文版)</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Know Nothing</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/zh">Chinese Version(中文版)</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Dive into Project Euler Part 3 (41-60)</h1>

      <div class="post-meta">
        <span class="post-time"> 2014-09-02 12:04:41 CST </span>
        
          <span class="more-meta"> 1031 words </span>
          <span class="more-meta"> 3 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#problem-41">Problem 41</a></li>
    <li><a href="#problem-42">Problem 42</a></li>
    <li><a href="#problem-43">Problem 43</a></li>
    <li><a href="#problem-44">Problem 44</a></li>
    <li><a href="#problem-45">Problem 45</a></li>
    <li><a href="#problem-46">Problem 46</a></li>
    <li><a href="#problem-47">Problem 47</a></li>
    <li><a href="#problem-48">Problem 48</a></li>
    <li><a href="#problem-49">Problem 49</a></li>
    <li><a href="#problem-50">Problem 50</a></li>
    <li><a href="#problem-51">Problem 51</a></li>
    <li><a href="#problem-52">Problem 52</a></li>
    <li><a href="#problem-53">Problem 53</a></li>
    <li><a href="#problem-54">Problem 54</a></li>
    <li><a href="#problem-55">Problem 55</a></li>
    <li><a href="#problem-56">Problem 56</a></li>
    <li><a href="#problem-57">Problem 57</a></li>
    <li><a href="#problem-58">Problem 58</a></li>
    <li><a href="#problem-59">Problem 59</a></li>
    <li><a href="#problem-60">Problem 60</a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h1 id="problem-41">Problem 41</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Max@Table[ Select[FromDigits /@ Permutations[Range[i]], PrimeQ], {i, 9}]
7652413
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-42">Problem 42</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">s = (Total[ToCharacterCode[#] - First@ToCharacterCode[&#34;A&#34;] + 1]) &amp; /@ StringSplit[StringReplace[Import[&#34;R:\\words.txt&#34;], &#34;\&#34;&#34; -&gt; &#34;&#34;],   &#34;,&#34;];
Reduce[n*(n + 1)/2 &gt;Max[s] &amp;&amp; n &gt; 0, n, Integers]
n &gt;= 20
In[37]:= tn = Array[#*(# + 1)/2 &amp;, 20];
In[38]:= Select[s, MemberQ[tn, #] &amp;] // Length
Out[38]= 162
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-43">Problem 43</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">cf = With[{
    code =
     And @@ Thread[
         Table[100 A[[i]] + 10 A[[i + 1]] + A[[i + 2]], {i, 2, 8}]~
           Mod~{2, 3, 5, 7, 11, 13, 17} == 0] // Boole // Quiet
    },
   Compile[{ {A, _Integer, 1} },
    code,
    RuntimeAttributes -&gt; Listable,
    RuntimeOptions -&gt; &#34;Speed&#34;, CompilationTarget -&gt; &#34;C&#34;
    ]
   ];
FromDigits /@ Pick[#, cf@#, 1] &amp;@Permutations@Range[0, 9] // Tr
16695334890
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-44">Problem 44</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">flag</span><span class="o">=</span><span class="nb">true</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">j</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">;</span>
	<span class="kt">double</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">n</span><span class="o">=</span><span class="n">i</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
		<span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">;</span><span class="o">--</span><span class="n">j</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">m</span><span class="o">=</span><span class="n">j</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
			<span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">24</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="p">;</span>
			<span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">24</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="p">;</span>
			<span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="kt">int</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="n">b</span><span class="o">==</span><span class="kt">int</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
			<span class="p">{</span>
				<span class="n">flag</span><span class="o">=</span><span class="nb">false</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="n">i</span><span class="o">++</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;j:%d</span><span class="se">\n</span><span class="s">i:%d</span><span class="se">\n</span><span class="s">m:%d</span><span class="se">\n</span><span class="s">n:%d</span><span class="se">\n</span><span class="s">n-m:%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">);</span>
<span class="p">}</span>
<span class="nl">j</span><span class="p">:</span><span class="mi">1020</span>
<span class="nl">i</span><span class="p">:</span><span class="mi">2168</span>
<span class="nl">m</span><span class="p">:</span><span class="mi">1560090</span>
<span class="nl">n</span><span class="p">:</span><span class="mi">7042750</span>
<span class="n">n</span><span class="o">-</span><span class="nl">m</span><span class="p">:</span><span class="mi">5482660</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-45">Problem 45</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">n = 60000;
T = Array[# (# + 1)/2 &amp;, n];
P = Array[# (3 # - 1)/2 &amp;, n];
H = Array[# (2 # - 1) &amp;, n];
Intersection[T, P, H] 
{1, 40755, 1533776805}
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-46">Problem 46</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">In[17]:= CanWritten[n_] :=Count[n - Array[2*#^2 &amp;, Floor@Sqrt[n/2]], i_ /; PrimeQ@i] &gt; 0;
In[18]:= AbsoluteTiming@Select[Range[3, 6000, 2], CompositeQ@# &amp;&amp; ! CanWritten@# &amp;]
Out[18]= {0.467058, {5777, 5993}}
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-47">Problem 47</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Checker[n_, m_] :=(Length /@ (Part[#, All, 1] &amp; /@ FactorInteger[Range[n, n + m - 1]])) == ConstantArray[m, m]
In[83]:= Select[Range[2, 2*^5], Checker[#, 4] &amp;]
Out[83]= {134043}
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-48">Problem 48</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">FromDigits[Take[IntegerDigits[Sum[i^i, {i, 1000}]], -10]]
9110846700
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-49">Problem 49</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">s = Select[Range[1000, 9999], PrimeQ];
t = Select[s, MemberQ[s, # + 3330] &amp;&amp; MemberQ[s, # + 6660] &amp;];
u = Table[{i, i + 3330, i + 6660}, {i, t}];
Select[u, Length[DeleteDuplicates[Sort /@ IntegerDigits[#]]] == 1 &amp;]
{ {1487, 4817, 8147}, {2969, 6299, 9629} }
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-50">Problem 50</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">In[138]:= s = 0; NestWhile[(# + 1) &amp;, 1, (s += Prime[#]) &lt; 1*^6 &amp;]
Out[138]= 547
as = Accumulate[Array[Prime, 546]];
In[145]:= For[i = 546, i &gt; 0, i--,
For[j = 1, j &lt; i, j++,
  If[PrimeQ[as[[i]] - as[[j]]],
   Return[{&#34;from&#34;, Prime[j], &#34;to&#34;, Prime[i], i - j, &#34;primes&#39;stotal:&#34;,
     as[[i]] - as[[j]]}]]
  ]
]
Out[145]= Return[{&#34;from&#34;, 5, &#34;to&#34;, 3931, 543, &#34;primes&#39;stotal:&#34;,  997651}]
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-51">Problem 51</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">ps = Table[Prime[i], {i, PrimePi[1*^4] + 1, PrimePi[1*^6]}];
RepPrimeCount[n_, r_] := 
  Block[{m = Most@IntegerDigits[n], l = Last@IntegerDigits[n]}, 
   Count[Table[FromDigits@Append[ReplaceAll[m, i], l], {i,      Array[r -&gt; # &amp;, 10, 0]}], d_ /; IntegerLength@d == IntegerLength@n &amp;&amp; PrimeQ@d]];
Filter[n_] := Block[{s = Most@IntegerDigits@n}, Or @@ Table[Count[s, i] == 3 &amp;&amp; RepPrimeCount[n, i] == 8, {i, 0, 2}]];
Select[ps, Filter@# &amp;]
{121313}
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-52">Problem 52</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">NestWhile[# + 1 &amp;, 1, Length@DeleteDuplicates[Sort /@ (IntegerDigits@(Range[6]*#))] != 1 &amp;]
142857
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-53">Problem 53</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Count[Flatten@Table[Binomial[n, r], {n, 1, 100}, {r, 1, n}], d_ /; d &gt; 1*^6]
4075
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-54">Problem 54</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">hands = Import[&#34;e:\\U盘\\p054_poker.txt&#34;, &#34;Table&#34;];
type[cards_] :=
Module[{},
  values = FromDigits /@ ((StringTake[#, 1] &amp; /@ cards) /. {&#34;A&#34; -&gt;&#34;14&#34;, &#34;K&#34; -&gt; &#34;13&#34;, &#34;Q&#34; -&gt; &#34;12&#34;, &#34;J&#34; -&gt; &#34;11&#34;, &#34;T&#34; -&gt; &#34;10&#34;}) //Sort // Reverse;
  suites = StringTake[#, -1] &amp; /@ cards;
  valuepat = Tally[values][[;; , 2]] // Sort // Reverse;
  FirstComVal = First@Commonest@values;
  Which[
   Length@Union@suites == 1 &amp;&amp;Differences@values == {-1, -1, -1, -1}, {9, values}, (*Royal/Straight Flush*)
   valuepat == {4, 1}, {8, Commonest[values, 2]},
   valuepat == {3, 2}, {7, Commonest[values, 2]},
   Length@Union@suites == 1, {6, values},
   Differences@values == {-1, -1, -1, -1}, {5, values},
   valuepat == {3, 1, 1}, {4, Prepend[DeleteCases[values, FirstComVal], FirstComVal]},
   valuepat == {2, 2, 1}, {3,  Append[Commonest[values, 2] // Sort // Reverse,    First@Complement[values, Commonest[values, 2]]]},
   valuepat == {2, 1, 1, 1}, {2,  Prepend[DeleteCases[values, FirstComVal], FirstComVal]},
   True, {1, values}
   ]
  ]
GetWinner[hand_] :=  Module[{}, Player1 = type[hand[[;; 5]]];  Player2 = type[hand[[6 ;;]]];
   If[Player1[[1]] &gt; Player2[[1]], Return[1],
    If[Player1[[1]] &lt; Player2[[1]], Return[2],
     For[i = 1, i &lt;= Length@Player1[[2]], i++,
      If[Player1[[2, i]] &gt; Player2[[2, i]], Return[1],
       If[Player1[[2, i]] &lt; Player2[[2, i]], Return[2]]
       ]
      ]
     ]
    ]
   ];
Count[GetWinner /@ hands, 1]
376
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-55">Problem 55</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Rev[n_] := FromDigits@Reverse@IntegerDigits@n;
IsPal[n_] := n == Rev@n;
IsLychrel[n_] :=  TrueQ[For[m = n + Rev@n; i = 1, i &lt;= 50, i++,  If[IsPal@m, Return@False, m += Rev@m]] == Null]Count[IsLychrel /@ Range[10000], True]
249
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-56">Problem 56</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Max[Total /@ IntegerDigits@Flatten@Array[#1^#2 &amp;, {99, 99}]]
972
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-57">Problem 57</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Count[Convergents[Sqrt@2,1001],f_/;IntegerLength@Numerator@f&gt;IntegerLength@Denominator@f] 
153
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-58">Problem 58</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">f[3]=3;
f[n_]:=f[n]=f[n-2]+Count[PrimeQ[Array[(n-2)^2+(n-1)#&amp;,3]],True];
NestWhile[#+2&amp;,3,f[#]/(2#-1)&gt;=0.1&amp;]
26241
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-59">Problem 59</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">EncryptText = FromDigits /@ StringSplit[Import[&#34;p059_cipher.txt&#34;], &#34;,&#34;];
key=StringJoin@
Flatten@Table[
   FromCharacterCode[
    ToCharacterCode[&#34;a&#34;] - 1 +
     Position[
      Array[BitXor[First@ToCharacterCode[&#34; &#34;], #] &amp;, 26, First@ToCharacterCode[&#34;a&#34;]],
      First@Commonest@EncryptText[[i ;; ;; 3]]
      ]
    ], {i, 3}]
&#34;god&#34;
Total@MapIndexed[BitXor[#1, ToCharacterCode[key][[Mod[#2, 3, 1]]]] &amp;, EncryptText]
107359
</code></pre></td></tr></table>
</div>
</div><h1 id="problem-60">Problem 60</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">ps = Array[Prime, PrimePi@10000];
FilterQ[n_] :=  Select[ps, # &gt; n &amp;&amp;  AllTrue[{n*(10^IntegerLength@#) + #, #*(10^IntegerLength@n) + n},      PrimeQ] &amp;];
For[ia = 1, ia &lt;= Length@ps, ia++, a = ps[[ia]];
seta = FilterQ@a;
For[ib = 1, ib &lt;= Length@seta, ib++, b = seta[[ib]];
  setb = FilterQ@b;
  setbi = Intersection[seta, setb];
  For[ic = 1, ic &lt;= Length@setbi, ic++, c = setbi[[ic]];
   setc = FilterQ@c;
   setci = Intersection[setbi, setc];
   For[id = 1, id &lt;= Length@setci, id++, d = setci[[id]];
    setd = FilterQ@d;
    setdi = Intersection[setci, setd];
    If[Length@setdi &gt; 0, Return[Total@{a, b, c, d, First@setdi}]]]]]]
Return[26033]
</code></pre></td></tr></table>
</div>
</div>
    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">bigheadghost</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2014-09-02 12:04:41 CST
        
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">License</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>
<div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">Reward</label>
  <div class="qr-code">
    
    <label class="qr-code-image" for="reward">
        <img class="image" src="/img/reward/wechat.jpg">
        <span>wechat</span>
      </label>
    <label class="qr-code-image" for="reward">
        <img class="image" src="/img/reward/alipay.jpg">
        <span>alipay</span>
      </label>
  </div>
</div><footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/mathematica/">Mathematica</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/dive-into-project-euler-part-4-61-80/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Dive into Project Euler Part 4 (61-80)</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/dive-into-project-euler-part-2-21-40/">
            <span class="next-text nav-default">Dive into Project Euler Part 2 (21-40)</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js" crossorigin="anonymous"></script>
    <script type="text/javascript">
      var gitalk = new Gitalk({
        id: '2014-09-02 12:04:41 \u002b0800 CST',
        title: 'Dive into Project Euler Part 3 (41-60)',
        clientID: '475a8b92e37771f12f1f',
        clientSecret: 'd20ef7f3742b04f540f45755d7c3e986aed524fa',
        repo: 'bigheadghost.github.io',
        owner: 'bigheadghost',
        admin: ['bigheadghost'],
        body: decodeURI(location.href)
      });
      gitalk.render('gitalk-container');
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/gitalk/gitalk">comments powered by gitalk.</a></noscript>

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:bigheadghost@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://math.stackexchange.com/users/157947/bigheadghost" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="https://github.com/bigheadghost" class="iconfont icon-github" title="github"></a>
      <a href="https://www.douban.com/people/1254984/" class="iconfont icon-douban" title="douban"></a>
  <a href="https://bigheadghost.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2014 - 
    2021<span class="heart"><i class="iconfont icon-heart"></i></span><span>bigheadghost</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>














</body>
</html>
